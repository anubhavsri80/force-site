<!DOCTYPE html>
<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<link rel="stylesheet" href="lead_form.css">
</head>
<body>
	<!-- Begin Default Content REMOVE THIS -->
<style type="text/css">.embeddedServiceHelpButton .helpButton .uiButton {
        background-color: #005290;
        font-family: "Arial", sans-serif;
    }
    .embeddedServiceHelpButton .helpButton .uiButton:focus {
        outline: 1px solid #005290;
    }
</style>
<script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script><script type='text/javascript'>
    var initESW = function(gslbBaseURL) {
        embedded_svc.settings.displayHelpButton = true; //Or false
        embedded_svc.settings.language = ''; //For example, enter 'en' or 'en-US'
        //embedded_svc.settings.defaultMinimizedText = '...'; //(Defaults to Chat with an Expert)
        //embedded_svc.settings.disabledMinimizedText = '...'; //(Defaults to Agent Offline)
        //embedded_svc.settings.loadingText = ''; //(Defaults to Loading)
        //embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)
        // Settings for Chat
        //embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
            // Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
            // Returns a valid button ID.
        //};
        //embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
        //embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
        //embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)
        embedded_svc.settings.enabledFeatures = ['LiveAgent'];
        embedded_svc.settings.entryFeature = 'LiveAgent';
        embedded_svc.init(
            'https://ecagroup--ecauat.my.salesforce.com',
            'https://ecauat-educationcentreofaustralia.cs114.force.com',
            gslbBaseURL,
            '00D1y0000008ksU',
            'WhatsApp_Chat_Team',
            {
                baseLiveAgentContentURL: 'https://c.la2-c1cs-hnd.salesforceliveagent.com/content',
                deploymentId: '5721y0000004CTH',
                buttonId: '5731y0000004CPK',
                baseLiveAgentURL: 'https://d.la2-c1cs-hnd.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'WhatsApp_Chat_Team',
                isOfflineSupportEnabled: false
            }
        );
    };
    if (!window.embedded_svc) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://ecagroup--ecauat.my.salesforce.com/embeddedservice/5.0/esw.min.js');
        s.onload = function() {
            initESW(null);
        };
        document.body.appendChild(s);
    } else {
        initESW('https://service.force.com');
    }
</script>
	
	<div class="container">  
  <form id="lead_form" action="" method="post">
    <h3>Fill up the form</h3>
    <h4>Contact us for custom quote</h4>
    <fieldset>
	<label ><b>Name</b><abbr>*</abbr> &nbsp;&nbsp;</label>
      <input placeholder="Name" type="text" name="fname" tabindex="1" required autofocus>
    </fieldset>
    <fieldset>
	    <label ><b>Adderss</b>&nbsp;&nbsp;</label>
      <input placeholder="Adderss" type="text" name="lname" tabindex="2" >
    </fieldset>
    <fieldset>
	    <label ><b>Company</b><abbr>*</abbr> &nbsp;&nbsp;</label>
      <input placeholder="Company" type="text"  name="company"tabindex="3" required>
    </fieldset>
    <fieldset>
	    <label ><b>Email</b><abbr>*</abbr> &nbsp;&nbsp;</label>
      <input placeholder="Email address" type="email" name="email" tabindex="4" required>
    </fieldset>
    <fieldset>
	    <label ><b>Phone no.</b> &nbsp;&nbsp;</label>
      <input placeholder="Phone no." type="tel" name="phoneno" tabindex="5" ></textarea>
    </fieldset>
    <fieldset>
      <button name="submit" type="submit" id="lead_form-submit" data-submit="...Sending">Submit</button>
    </fieldset>
   
  </form>
	<iframe src="https://go.pardot.com/l/919353/2021-04-09/65l" width="100%" height="500px" ></iframe>
	
</div>

<script type="text/javascript">
	const serialize_form = form => JSON.stringify(Array.from(new FormData(form).entries()).reduce((m, [key, value]) => Object.assign(m, {
		[key]: value
	}), {}));
	$('#lead_form').on('submit', function(event) {
		event.preventDefault();
		const json = serialize_form(this);
		console.log(json);
		/*	var xmlhttp = new XMLHttpRequest();   // new HttpRequest instance 
	var theUrl = "https://leadgenerationgkn-developer-edition.ap16.force.com/GetData/services/apexrest/myservice/";
	xmlhttp.open("POST", theUrl);
	xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
	xmlhttp.send(json); */
		$.ajax({
			type: 'POST',
			//https://site-gkns-developer-edition.ap16.force.com/web2lead/services/apexrest/leadgenerationservice
			//url: 'https://leadgenerationgkn-developer-edition.ap16.force.com/GetData/services/apexrest/myservice/',
			//url: 'https://site-gkns-developer-edition.ap16.force.com/web2lead/services/apexrest/leadgenerationservice',
			url:'https://gksapp-developer-edition.ap16.force.com/services/apexrest/myservice',
			dataType: 'json',
			data: json,
			contentType: 'application/json',
			success: function(data) {
				alert(data)
			}
		});
	});
	</script>

</body>
</html>
